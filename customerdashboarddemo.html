<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard - LocalConnect</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Custom scrollbar for a better look on dark theme */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a202c; /* dark-gray */
        }
        ::-webkit-scrollbar-thumb {
            background: #020407; /* medium-gray */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096; /* light-gray */
        }
    </style>
</head>
<body class="bg-gray-900 text-white antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <header class="text-center mb-4">
            <h1 class="text-4xl font-bold text-blue-400">LocalConnect</h1>
            <p class="text-gray-400 mt-2">Find trusted local service providers near you.</p>
        </header>

        <div class="text-center mb-8">
            <p class="text-lg text-gray-300">Welcome to your dashboard!</p>
        </div>

        <div class="bg-gray-800 p-6 rounded-lg shadow-lg mb-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-end">
                
                <div class="md:col-span-2">
                    <label for="location" class="block text-sm font-medium text-gray-300 mb-2">Location</label>
                    <div class="flex flex-row gap-2">
                        <input type="text" id="location" placeholder="Enter city or zip code" class="flex-grow w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button id="getLocationBtn" class="flex-shrink-0 flex items-center justify-center gap-2 bg-gray-600 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded-md transition duration-300">
                            <i class="fas fa-location-arrow"></i>
                            <span class="hidden sm:inline">Use My Location</span>
                        </button>
                    </div>
                </div>

                <div>
                    <label for="serviceCategory" class="block text-sm font-medium text-gray-300 mb-2">Service</label>
                    <select id="serviceCategory" class="w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>All Services</option>
                        <option>Plumber</option>
                        <option>Electrician</option>
                        <option>Mechanic</option>
                        <option>Carpenter</option>
                        <option>Painter</option>
                    </select>
                </div>
            </div>
            
            <div class="mt-6">
                <button id="searchBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105">
                    Search Providers
                </button>
            </div>
        </div>
        
        <div id="statusMessage" class="text-center my-4 text-gray-400"></div>

        <div id="results" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            </div>

    </div>

    <script>
        // --- DOM Elements ---
        const getLocationBtn = document.getElementById('getLocationBtn');
        const locationInput = document.getElementById('location');
        const searchBtn = document.getElementById('searchBtn');
        const resultsContainer = document.getElementById('results');
        const statusMessage = document.getElementById('statusMessage');
        const serviceCategorySelect = document.getElementById('serviceCategory');

        // --- Mock Data for Service Providers ---
        // In a real application, this data would come from your database via a PHP/API call.
        const allProviders = [
            { name: 'John Doe', service: 'Plumber', distance: '2.5 km', rating: 4.5, img: 'https://placehold.co/100x100/3B82F6/FFFFFF?text=JD' },
            { name: 'Jane Smith', service: 'Electrician', distance: '3.1 km', rating: 4.8, img: 'https://placehold.co/100x100/3B82F6/FFFFFF?text=JS' },
            { name: 'Mike Richards', service: 'Mechanic', distance: '1.8 km', rating: 4.2, img: 'https://placehold.co/100x100/3B82F6/FFFFFF?text=MR' },
            { name: 'Sarah Lee', service: 'Carpenter', distance: '5.0 km', rating: 4.9, img: 'https://placehold.co/100x100/3B82F6/FFFFFF?text=SL' },
            { name: 'David Chen', service: 'Plumber', distance: '4.2 km', rating: 4.3, img: 'https://placehold.co/100x100/3B82F6/FFFFFF?text=DC' },
            { name: 'Emily White', service: 'Electrician', distance: '0.9 km', rating: 5.0, img: 'https://placehold.co/100x100/3B82F6/FFFFFF?text=EW' },
             { name: 'Chris Green', service: 'Painter', distance: '6.1 km', rating: 4.6, img: 'https://placehold.co/100x100/3B82F6/FFFFFF?text=CG' },
             { name: 'Brian Adams', service: 'Mechanic', distance: '7.2 km', rating: 4.7, img: 'https://placehold.co/100x100/3B82F6/FFFFFF?text=BA' },
        ];

        // --- Functions ---

        /**
         * Displays a message to the user (e.g., loading, error).
         * @param {string} message - The message to display.
         * @param {string} type - 'info', 'success', or 'error'.
         */
        function showStatus(message, type = 'info') {
            statusMessage.textContent = message;
            statusMessage.className = 'text-center my-4 ';
            if (type === 'error') {
                statusMessage.classList.add('text-red-400');
            } else if (type === 'success') {
                statusMessage.classList.add('text-green-400');
            } else {
                statusMessage.classList.add('text-gray-400');
            }
        }

        /**
         * Renders the service provider cards to the page.
         * @param {Array} providers - An array of provider objects.
         */
        function displayProviders(providers) {
            resultsContainer.innerHTML = ''; // Clear previous results
            if (providers.length === 0) {
                showStatus('No service providers found for your search.', 'info');
                return;
            }
            
            providers.forEach(provider => {
                const card = `
                    <div class="bg-gray-800 rounded-lg shadow-lg p-5 flex flex-col items-center text-center transform hover:-translate-y-1 transition duration-300">
                        <img src="${provider.img}" onerror="this.onerror=null;this.src='https://placehold.co/100x100/1F2937/FFFFFF?text=Img';" alt="${provider.name}" class="w-24 h-24 rounded-full border-4 border-blue-500 mb-4">
                        <h3 class="text-xl font-semibold text-white">${provider.name}</h3>
                        <p class="text-blue-400 font-medium">${provider.service}</p>
                        <div class="text-gray-400 text-sm my-2">
                            <span>${provider.distance} away</span> &bull; 
                            <span><i class="fas fa-star text-yellow-400"></i> ${provider.rating}</span>
                        </div>
                        <button class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md transition duration-300">
                            View Profile
                        </button>
                    </div>
                `;
                resultsContainer.innerHTML += card;
            });
        }

        /**
         * Handles the geolocation API call.
         */
        function handleGetLocation() {
            if (navigator.geolocation) {
                showStatus('Fetching your location...', 'info');
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const { latitude, longitude } = position.coords;
                        // In a real app, you would use a reverse geocoding service
                        // to convert coords to a city name.
                        locationInput.value = `Lat: ${latitude.toFixed(2)}, Lon: ${longitude.toFixed(2)}`;
                        showStatus('Location found!', 'success');
                    },
                    (error) => {
                        showStatus('Could not get location. Please enter it manually.', 'error');
                        console.error("Geolocation error:", error);
                    }
                );
            } else {
                showStatus('Geolocation is not supported by your browser.', 'error');
            }
        }

        /**
         * Simulates searching for providers.
         */
        function handleSearch() {
            const location = locationInput.value;
            const category = serviceCategorySelect.value;
            
            if (!location) {
                showStatus('Please provide a location to search.', 'error');
                return;
            }

            showStatus(`Searching for '${category}' near '${location}'...`, 'info');
            resultsContainer.innerHTML = ''; // Clear results while "searching"

            // Simulate a network delay
            setTimeout(() => {
                let filteredProviders = allProviders;

                if (category !== 'All Services') {
                    filteredProviders = allProviders.filter(p => p.service === category);
                }
                
                showStatus('', 'info'); // Clear status message
                displayProviders(filteredProviders);
            }, 1500); // 1.5-second delay
        }


        // --- Event Listeners ---
        getLocationBtn.addEventListener('click', handleGetLocation);
        searchBtn.addEventListener('click', handleSearch);

        // --- Initial Load ---
        // Display a welcome message on page load.
        showStatus('Enter a location and service to find help nearby.');

    </script>

</body>
</html>